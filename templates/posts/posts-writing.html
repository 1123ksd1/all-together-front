<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../../static/css/style.css">
    <title>posts-writing</title>
</head>
<body>
    <div id="header"></div>
    <script src="/static/js/header.js"></script>
    <main class="posts-main">
        <div class="posts-main-content">
            <div class="main-left">
                <nav class="main-left__nav">
                    <div class="main-left__nav-yellow"></div>
                    <div class="main-left__nav-bookmark"></div>
                    <div class="main-left__nav-white">
                        <img src="../../static/image/main-logo.svg">
                        <div class="main-left__nav-title"><span>Damo.yeo</span></div><div class="main-left__nav-border"></div>
                        <ul class="post-nav">
                            <li class="post-nav__list"><a href="#">전체글</a></li><div class="main-left__nav-border"></div>
                            <li class="post-nav__list"><a href="#">실시간 인기글</a> </li><div class="main-left__nav-border"></div>
                            <li class="post-nav__list"><a href="#">게시판 모음</a></li><div class="main-left__nav-border"></div>
                            <li class="post-nav__list"><a href="#">알바 게시판</a></li>
                            <li class="post-nav__list"><a href="#">과외 게시판</a></li>
                            <li class="post-nav__list"><a href="#">취준 게시판</a></li>
                            <li class="post-nav__list"><a href="#">경력단절 게시판</a></li><div class="main-left__nav-border"></div>
                            <li class="post-nav__list"><a href="#">공지사항</a></li><div class="main-left__nav-border"></div>
                            <li class="post-nav__list"><a href="#">이벤트</a></li><div class="main-left__nav-border"></div>
                            
                        </ul>
                    </div>
                </nav>
            </div>
            <div class="main-right">
                <header class="main-right__title">글쓰기</header>
                <div class="main-right__hr main-right__hr--lighter"></div>

                <div class="main-right__choose-posts">
                    <form class="main-right__choose-posts-btn" action="/informations/region/" method="GET" id="align_mode_form" class="align_mode_form">
                        <select name="align_mode" id="align_mode" class="align_mode--writing-page">
                            <option value="recently">게시판을 선택해 주세요.</option>
                            <option value="recently">실시간 인기글</option>
                            <option value="recently">실시간 인기글</option>
                            <option value="recently">실시간 인기글</option>
                        </select>
                    </form>

                </div>
                <div class="main-right__input-title">
                    <form class="main-right__input-title-form">
                        <input type="text" placeholder="제목을 입력해 주세요.">
                    </form>
                </div>
                <div class="main-right__editor">
                    <label for="btn-image" class="editor-top editor-top-image">
                        <form><input type="file" id="btn-image" style="display: none;"></form>
                        <img height="34px" src="../../static/image/image.svg">
                        <span>사진</span>
                    </label>
                    <label for="btn-video" class="editor-top editor-top-video">
                        <form><input type="file" id="btn-video" style="display: none;"></form>
                        <img src="../../static/image/video.svg">
                        <span>동영상</span>
                    </label>

                    <button id="btn-file" class="editor-top editor-top-file">
                        <img height="34px" src="../../static/image/file.svg">
                        <span>파일</span>
                    </button>
                    <button id="btn-link" class="editor-top editor-top-link">
                        <img src="../../static/image/link.svg">
                        <span>링크</span>
                    </button>
                    <button id="btn-save" class="editor-top editor-top-save">
                        <img src="../../static/image/save.svg">
                        <span>저장하기</span>
                    </button>
                </div>
                <div class="textarea">
                    <div  id="textarea" class="main-right__input-text" contenteditable="true"></div>
                </div>

                <form class="save-form" style="background-color: antiquewhite;">
                    <input type="button" value="저장하기">
                </form>

    
            </div>
        </div>
    </main>
    <div id="footer"></div>
    <script src="../../static/js/footer.js"></script>

    <script>
    const imageInput = document.getElementById('btn-image');
    const videoInput = document.getElementById('btn-video');
    const textarea = document.getElementById('textarea');
    const maxHeight = 834; // 원하는 최대 높이 (px)
    textarea.addEventListener('input', function () {
        if (textarea.scrollHeight > maxHeight) {
            textarea.style.overflow = 'auto';
        } else {
            textarea.style.overflow = 'hidden';
        }
    });


    imageInput.addEventListener('change', function (event) {
    const file = event.target.files[0];
    if (file) {
        // 파일 확장자 확인
        const allowedExtensions = ['jpg', 'jpeg', 'png', 'gif'];
        const fileExtension = file.name.split('.').pop().toLowerCase();

        if (allowedExtensions.includes(fileExtension)) {
            const reader = new FileReader();
            reader.onload = function (e) {
                const img = document.createElement('img');
                img.src = e.target.result;
                textarea.appendChild(img);
            };
            reader.readAsDataURL(file);
        } else {
            alert('이미지 파일만 등록할 수 있습니다.');
            // 파일 선택 초기화
            imageInput.value = '';
        }
    }
});
    
videoInput.addEventListener('change', function (event) {
    const file = event.target.files[0];
    if (file) {
        // 파일 확장자 확인
        const allowedExtensions = ['mp4', 'avi', 'mov', 'wmv'];
        const fileExtension = file.name.split('.').pop().toLowerCase();

        if (allowedExtensions.includes(fileExtension)) {
            const reader = new FileReader();
            reader.onload = function (e) {
                const video = document.createElement('video');
                video.src = e.target.result;
                video.controls = true;
                video.style.width = "700px";
                video.style.height = "500px";
                video.style.marginLeft = "80px";
                video.style.position = 'relative'; // 포지션 추가
                video.style.zIndex = 1; // z-index 설정
                video.style.cursor = 'move'; // 이동할 수 있는 커서 설정

                let offsetX, offsetY, startX, startY, isDragging = false;

                video.addEventListener('mousedown', function (e) {
                    e.preventDefault();
                    isDragging = true;
                    startX = e.clientX;
                    startY = e.clientY;
                    offsetX = parseFloat(video.style.marginLeft) || 0;
                    offsetY = parseFloat(video.style.marginTop) || 0;
                });

                document.addEventListener('mousemove', function (e) {
                    if (!isDragging) return;

                    const newX = offsetX + (e.clientX - startX);
                    const newY = offsetY + (e.clientY - startY);

                    video.style.marginLeft = newX + 'px';
                    video.style.marginTop = newY + 'px';
                });

                document.addEventListener('mouseup', function () {
                    isDragging = false;
                });

                textarea.appendChild(video);
            };
            reader.readAsDataURL(file);
        } else {
            alert('비디오 파일만 등록할 수 있습니다.');
            // 파일 선택 초기화
            videoInput.value = '';
        }
    }
});
</script>
    
</body>      
</html>